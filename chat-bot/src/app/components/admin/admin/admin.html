<div class="admin-layout">
  
  <!-- SIDEBAR (Menu Lateral) -->
  <aside class="sidebar" [class.open]="isMobileMenuOpen">
    <div class="brand">
      <h2>Love<span>Care</span></h2>
      <p>Painel Administrativo</p>
    </div>
    
    <nav class="nav-menu">
      <button (click)="activeTab = 'dashboard'; isMobileMenuOpen=false" 
              class="nav-btn" 
              [class.active]="activeTab === 'dashboard'">
        <span class="icon">üìä</span> Dashboard
      </button>
      <button (click)="activeTab = 'editor'; isMobileMenuOpen=false" 
              class="nav-btn" 
              [class.active]="activeTab === 'editor'">
        <span class="icon">‚úèÔ∏è</span> Editar Fluxo
      </button>
    </nav>

    <div class="sidebar-footer">
      <button (click)="goHome()" class="btn-secondary full-width">
        ‚¨Ö Sair / Ver Site
      </button>
    </div>
  </aside>

  <!-- OVERLAY MOBILE (Fundo escuro ao abrir menu) -->
  <div class="overlay" *ngIf="isMobileMenuOpen" (click)="toggleMobileMenu()"></div>

  <!-- CONTE√öDO PRINCIPAL -->
  <main class="main-content">
    
    <!-- HEADER MOBILE (S√≥ aparece no celular) -->
    <header class="mobile-header">
      <div class="brand-mobile">Love<span>Care</span></div>
      <button class="hamburger-btn" (click)="toggleMobileMenu()">‚ò∞</button>
    </header>

    <!-- VIS√ÉO 1: DASHBOARD -->
    <div *ngIf="activeTab === 'dashboard'" class="view-container fade-in">
      <div class="page-header">
        <h1>Vis√£o Geral</h1>
        <p>Acompanhe o impacto e as m√©tricas do chatbot.</p>
      </div>

      <!-- Cards de KPI -->
      <div class="kpi-grid">
        <div class="kpi-card">
          <div class="kpi-value">{{ totalInteractions }}</div>
          <div class="kpi-label">Intera√ß√µes Totais</div>
          <div class="kpi-bar green"></div>
        </div>
        <div class="kpi-card">
          <div class="kpi-value">{{ totalVisits }}</div>
          <div class="kpi-label">Visitas √önicas</div>
          <div class="kpi-bar purple"></div>
        </div>
        <div class="kpi-card highlight">
          <div class="kpi-value">{{ conversionRate }}</div>
          <div class="kpi-label">Taxa de Doa√ß√£o</div>
          <div class="kpi-bar pink"></div>
        </div>
      </div>

      <!-- Lista de Ranking -->
      <div class="chart-section">
        <h3>üî• Assuntos Mais Buscados</h3>
        <div class="ranking-list">
          <div *ngFor="let item of topInterests; let i = index" class="ranking-item">
            <div class="rank-info">
              <span class="rank-pos">#{{ i + 1 }}</span>
              <span class="rank-name">{{ item.name }}</span>
              <span class="rank-val">{{ item.value }} cliques</span>
            </div>
            <div class="progress-track">
              <div class="progress-fill" [style.width.%]="(item.value / totalInteractions) * 100"></div>
            </div>
          </div>
          
          <div *ngIf="topInterests.length === 0" class="empty-state">
            <p>Nenhum dado coletado ainda.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- VIS√ÉO 2: EDITOR DE FLUXO -->
    <div *ngIf="activeTab === 'editor'" class="view-container fade-in">
      <div class="page-header flex-between">
        <div>
          <h1>Editor de Fluxo</h1>
          <p>Gerencie as perguntas e respostas do rob√¥.</p>
        </div>
        
        <button class="btn-primary" (click)="save()" [disabled]="isLoading">
          {{ isLoading ? 'Salvando...' : 'üíæ Salvar Altera√ß√µes' }}
        </button>
      </div>

      <div class="cards-wrapper">
        
        <!-- Placeholder para Adicionar Novo -->
        <div class="add-card-placeholder" (click)="addCard()">
          <div class="plus-circle">+</div>
          <p>Criar Novo Passo</p>
        </div>

        <!-- Loop dos Cards Existentes -->
        <div *ngFor="let card of cards; let i = index" class="flow-card">
          <div class="card-header-strip">
            <span class="badge-id">{{ card.id }}</span>
            <button class="btn-icon-trash" (click)="removeCard(i)" *ngIf="card.id !== 'start'" title="Apagar Card">
              üóëÔ∏è
            </button>
          </div>
          
          <div class="card-body">
            <div class="form-group">
              <label>Mensagem do Rob√¥</label>
              <textarea [(ngModel)]="card.text" rows="3" class="form-control" placeholder="Digite a mensagem..."></textarea>
            </div>
            
            <div class="options-group">
              <label>Bot√µes de Resposta</label>
              
              <div class="options-list">
                <div *ngFor="let opt of card.options; let j = index" class="opt-row">
                  <input type="text" [(ngModel)]="opt.label" class="form-control small" placeholder="Texto do Bot√£o">
                  <input type="text" [(ngModel)]="opt.nextStep" class="form-control small" placeholder="Destino (ID ou Link)">
                  <button (click)="removeOption(card, j)" class="btn-icon-remove" title="Remover bot√£o">√ó</button>
                </div>
              </div>
              
              <button class="btn-secondary small-btn full-width" (click)="addOption(card)">
                + Adicionar Bot√£o
              </button>
            </div>
          </div>
        </div>

      </div>
    </div>

  </main>
</div>